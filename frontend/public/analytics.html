<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ZYRA | Advanced Analytics</title>
  <meta name="description" content="ZYRA advanced analytics with multiâ€‘chart intelligence, live metrics, and quantum UI." />
  <meta name="theme-color" content="#22c55e" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=JetBrains+Mono:wght@400;600;700&family=Orbitron:wght@700;900&display=swap" rel="stylesheet">
  <style>
    :root {
      --q-primary: #00ff95; /* neon green */
      --q-secondary: #16a34a; /* emerald */
      --q-accent: #84cc16; /* lime */
      --q-success: #22c55e;
      --q-danger: #ef4444;
      --q-bg-0: #050607; /* near black */
      --q-bg-1: #0a0f0a; /* black with green hint */
      --glass: rgba(255,255,255,0.06);
      --glass-strong: rgba(255,255,255,0.10);
      --glass-border: rgba(255,255,255,0.14);
      --text: #e8fcea; /* slightly green-tinted white */
      --text-dim: #a9f5c9;
      --shadow-q: 0 10px 50px rgba(34,197,94,.25);
      --grid-line: #b7f5d1;
      --chart-grid: rgba(74,222,128,.10);
      --chart-grid-weak: rgba(74,222,128,.06);
      --chart-tick: #c5ffde;
      --tooltip-bg: rgba(6,12,10,.92);
      --tooltip-title: #eafff2;
      --tooltip-body: #d5ffe8;
      --tooltip-border: rgba(134,239,172,.25);
    }
    * { box-sizing: border-box; }
    body { margin:0; color:var(--text); background: radial-gradient(1200px 800px at 15% 10%, #0b1a12 0%, transparent 60%),
                              radial-gradient(1000px 900px at 95% 0%, #08140c 0%, transparent 55%),
                              linear-gradient(180deg, #040605 0%, #040605 100%); font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto; }
    .animated-bg { position: fixed; inset: -20vmax; z-index: -2; filter: blur(80px) saturate(140%); opacity: .5;
      background: conic-gradient(from 180deg at 50% 50%, var(--q-primary), var(--q-secondary), var(--q-accent), var(--q-primary));
      animation: swirl 30s linear infinite; }
    @keyframes swirl { to { transform: rotate(360deg); }}
    .particles { position: fixed; inset: 0; pointer-events:none; z-index:-1; }
    .dot { position:absolute; width:2px; height:2px; background:#86efac; border-radius:999px; opacity:.8; }
    header { position: sticky; top: 0; z-index: 50; backdrop-filter: blur(12px);
      background: linear-gradient(180deg, rgba(8,12,24,.85), rgba(8,12,24,.6)); border-bottom: 1px solid var(--glass-border); }
    .wrap { max-width: 1200px; margin: 0 auto; padding: .9rem 1.25rem; display:flex; align-items:center; gap:1rem; }
    .brand { display:flex; align-items:center; gap:.75rem; text-decoration:none; color:var(--text); }
    .logo { width:44px; height:44px; border-radius:14px; position:relative; overflow:hidden; box-shadow: 0 0 0 1px #145532, var(--shadow-q);
      background: radial-gradient(120% 120% at 10% 10%, #0f2a1a 0%, #0a1510 60%, #070e0a 100%); }
    .logo::before { content:''; position:absolute; inset:-40%; background: conic-gradient(from 0deg, transparent 0 40%, #22ff88 50%, transparent 60% 100%); animation: spin 5s linear infinite; filter: blur(6px); opacity:.9; }
    .logo::after { content:'Z'; position:absolute; inset:0; display:grid; place-items:center; font-family: Orbitron; font-weight:900; font-size:22px; color:#eafff2; text-shadow:0 0 12px #22ff88; letter-spacing:.08em; }
    @keyframes spin{ to{ transform: rotate(360deg); }}
    nav { margin-left: auto; display:flex; gap:.5rem; flex-wrap:wrap; }
    .nav-btn { position:relative; padding:.55rem .9rem; border-radius:12px; border:1px solid var(--glass-border); background:var(--glass); color:var(--text); font-weight:600; cursor:pointer; }
    .nav-btn.active { border-color:#22c55eaa; box-shadow: 0 0 0 1px #22c55e55, var(--shadow-q); background: linear-gradient(180deg, rgba(34,197,94,.12), rgba(34,197,94,.06)); }
    .pill { padding:.45rem .7rem; border-radius:999px; background:var(--glass); border:1px solid var(--glass-border); font-family:'JetBrains Mono', monospace; font-size:.85rem; color:var(--text-dim); }
    .cta { padding:.6rem 1rem; border-radius:12px; background: linear-gradient(90deg, var(--q-primary), var(--q-secondary)); border:0; color:#021412; font-weight:800; letter-spacing:.04em; cursor:pointer; }

    main { max-width:1200px; margin: 1.5rem auto 2rem; padding: 0 1.25rem; }
    .h-title { font-family: Orbitron, Inter, sans-serif; font-weight:900; font-size: clamp(1.8rem, 4.5vw, 3rem); margin:.2rem 0 .2rem; letter-spacing:.06em;
      background: linear-gradient(120deg, #eafff2 10%, var(--q-primary) 45%, var(--q-secondary) 60%, #e7ffe3 90%); -webkit-background-clip:text; background-clip:text; color:transparent; }
    .h-sub { color:var(--text-dim); margin:0 0 1rem; }

    .controls { display:flex; flex-wrap:wrap; gap:.6rem; align-items:center; margin:.8rem 0 1.2rem; }
    .seg { display:flex; border:1px solid var(--glass-border); background:var(--glass); border-radius:12px; overflow:hidden; }
    .seg button { background:transparent; color:var(--text); padding:.5rem .8rem; border:0; cursor:pointer; }
    .seg button.active{ background: linear-gradient(180deg, rgba(34,197,94,.12), rgba(34,197,94,.06)); }
    .switch { display:flex; align-items:center; gap:.45rem; }
    .switch input { accent-color: var(--q-success); }

    .kpis { display:grid; grid-template-columns: repeat(4,minmax(0,1fr)); gap:1rem; }
    .card { background:var(--glass); border:1px solid var(--glass-border); border-radius:16px; padding:1rem; position:relative; overflow:hidden; }
    .metric { font-family: Orbitron; font-weight:900; font-size: clamp(1.2rem, 3.2vw, 2rem); }
    .label { color:var(--text-dim); font-size:.85rem; margin-top:.25rem; }

    .charts { margin-top:1.4rem; display:grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap:1rem; }
    .chart { background:var(--glass); border:1px solid var(--glass-border); border-radius:16px; padding:1rem; position:relative; }
    .chart h3 { margin:.2rem 0 .8rem; color:#cfe9ff; }
    .actions { position:absolute; right:.6rem; top:.6rem; display:flex; gap:.4rem; }
    .actions button { border:1px solid var(--glass-border); background:var(--glass); color:var(--text); border-radius:10px; padding:.3rem .5rem; cursor:pointer; }

    .grid-overlay { position: fixed; inset: 0; z-index: -1; pointer-events: none; opacity: .08; background-image:
      linear-gradient(90deg, var(--grid-line) 1px, transparent 1px),
      linear-gradient(var(--grid-line) 1px, transparent 1px);
      background-size: 40px 40px; mix-blend-mode: screen; }

    @media (max-width: 980px){ .kpis{ grid-template-columns: repeat(2,minmax(0,1fr)); } }
  </style>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/ethers@5.7.2/dist/ethers.umd.min.js"></script>
</head>
<body>
  <div class="animated-bg" aria-hidden="true"></div>
  <div class="particles" id="particles" aria-hidden="true"></div>
  <div class="grid-overlay" aria-hidden="true"></div>

  <header>
    <div class="wrap">
      <a class="brand" href="index.html" aria-label="ZYRA Home">
        <div class="logo" aria-hidden="true"></div>
        <div class="wordmark" style="font-family:Orbitron;font-weight:900;letter-spacing:.12em;"> <span style="background:linear-gradient(90deg,var(--q-primary),var(--q-secondary));-webkit-background-clip:text;background-clip:text;color:transparent;">ZYRA</span>&nbsp;ANALYTICS</div>
      </a>
      <nav aria-label="Primary">
        <a class="nav-btn" href="index.html">Home</a>
        <a class="nav-btn" href="defi.html">DeFi</a>
        <span class="nav-btn active" aria-current="page">Analytics</span>
        <a class="nav-btn" href="nft.html">NFT</a>
      </nav>
      <button id="themeBtn" class="nav-btn" title="Toggle theme">ðŸŒ—</button>
      <div class="wallet">
        <div id="walletState" class="pill">Not Connected</div>
        <button id="walletBtn" class="cta">Connect Wallet</button>
      </div>
    </div>
  </header>

  <main>
    <h1 class="h-title">Advanced Network Analytics</h1>
    <p class="h-sub">Multiâ€‘dimensional charts, live playback and export tools for deep inspection of performance and reliability.</p>

    <div class="controls">
      <div class="seg" id="rangeSeg">
        <button data-range="24h" class="active">24h</button>
        <button data-range="7d">7d</button>
        <button data-range="30d">30d</button>
      </div>
      <div class="switch"><input type="checkbox" id="liveToggle"><label for="liveToggle">Live playback</label></div>
    </div>

    <section class="kpis">
      <div class="card"><div id="kpiTPS" class="metric">--</div><div class="label">Peak TPS</div></div>
      <div class="card"><div id="kpiLatency" class="metric">--</div><div class="label">Median Latency</div></div>
      <div class="card"><div id="kpiFinality" class="metric">--</div><div class="label">Avg Finality</div></div>
      <div class="card"><div id="kpiHealth" class="metric">--</div><div class="label">Health Score</div></div>
    </section>

    <section class="charts">
      <div class="chart"><div class="actions"><button data-dl="perf">PNG</button></div><h3>Throughput</h3><canvas id="chPerf"></canvas></div>
      <div class="chart"><div class="actions"><button data-dl="lat">PNG</button></div><h3>Latency</h3><canvas id="chLat"></canvas></div>
      <div class="chart"><div class="actions"><button data-dl="vol">PNG</button></div><h3>Volume</h3><canvas id="chVol"></canvas></div>
      <div class="chart"><div class="actions"><button data-dl="radar">PNG</button></div><h3>Cohesion Radar</h3><canvas id="chRadar"></canvas></div>
    </section>
  </main>

  <script>
    (function initParticles(){
      const host = document.getElementById('particles'); if(!host) return;
      const n=70; const w=()=>innerWidth; const h=()=>innerHeight;
      for(let i=0;i<n;i++){ const d=document.createElement('div'); d.className='dot'; reset(d,true); host.appendChild(d);} 
      function reset(el,first=false){ const sz=1+Math.random()*2.5; el.style.width=sz+'px'; el.style.height=sz+'px'; el.style.left=Math.random()*w()+'px'; el.style.top=Math.random()*h()+'px'; el.style.opacity=String(.35+Math.random()*.55); const hue=130+Math.random()*30; el.style.background=`hsl(${hue},85%,70%)`; el.style.boxShadow=`0 0 ${2+Math.random()*6}px hsl(${hue},85%,60%)`; const driftX=-40+Math.random()*80; const driftY=-30+Math.random()*60; const dur=6+Math.random()*6; el.animate([{transform:'translate(0,0)'},{transform:`translate(${driftX}px, ${driftY}px)`}],{duration:dur*1000,iterations:Infinity,direction:'alternate',easing:'ease-in-out',delay:first?Math.random()*3000:0}); }
      addEventListener('resize',()=>[...host.children].forEach(c=>reset(c)));
    })();

    function animateNumber(el, to, opts={}){
      const { prefix='', suffix='', duration=1000, decimals=0 } = opts; const start=performance.now(); const from=0; const fmt=v=> prefix + v.toFixed(decimals).replace(/\B(?=(\d{3})+(?!\d))/g, ',') + suffix; function tick(t){ const k=Math.min(1,(t-start)/duration); const eased=1-Math.pow(1-k,4); const v=from+(to-from)*eased; el.textContent=fmt(v); if(k<1) requestAnimationFrame(tick);} requestAnimationFrame(tick);
    }
    function updateKPIs(){
      animateNumber(document.getElementById('kpiTPS'), 52000+Math.random()*2500, {});
      animateNumber(document.getElementById('kpiLatency'), 70+Math.random()*30, {suffix:' ms'});
      animateNumber(document.getElementById('kpiFinality'), 1+Math.random()*2, {suffix:' s', decimals:2});
      const h = 90 + Math.floor(Math.random()*10); const el=document.getElementById('kpiHealth'); el.textContent=h + ' / 100'; el.style.color = h>94 ? 'var(--q-success)' : '#e8f2ff';
    }
    setInterval(updateKPIs, 3200); updateKPIs();

    const cssVars = () => { const cs = getComputedStyle(document.documentElement); return { grid: cs.getPropertyValue('--chart-grid').trim(), gridWeak: cs.getPropertyValue('--chart-grid-weak').trim(), tick: cs.getPropertyValue('--chart-tick').trim(), tbg: cs.getPropertyValue('--tooltip-bg').trim(), ttitle: cs.getPropertyValue('--tooltip-title').trim(), tbody: cs.getPropertyValue('--tooltip-body').trim(), tborder: cs.getPropertyValue('--tooltip-border').trim(), }; };
    let C = cssVars();

    function genLabels(range){
      if(range==='24h') return Array.from({length:24},(_,i)=>`${i}:00`);
      if(range==='7d') return ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
      return Array.from({length:30},(_,i)=>`D${i+1}`);
    }
    function rand(n,base=1,spread=1){ return Array.from({length:n},()=> base + Math.random()*spread ); }

    const chs = {};
    function buildCharts(range='24h'){
      const labels = genLabels(range);
      const ctxPerf = document.getElementById('chPerf').getContext('2d');
      const ctxLat  = document.getElementById('chLat').getContext('2d');
      const ctxVol  = document.getElementById('chVol').getContext('2d');
      const ctxRadar= document.getElementById('chRadar').getContext('2d');
      const o = {
        responsive:true, animation:false,
        plugins:{ legend:{display:false}, tooltip:{ backgroundColor:C.tbg, titleColor:C.ttitle, bodyColor:C.tbody, borderColor:C.tborder, borderWidth:1 } },
        scales:{ x:{ ticks:{color:C.tick}, grid:{color:C.gridWeak} }, y:{ ticks:{color:C.tick}, grid:{color:C.grid} } }
      };
      chs.perf = new Chart(ctxPerf,{ type:'line', data:{ labels, datasets:[{ label:'TPS', data: rand(labels.length, 50000, 3000), borderColor:'#22c55e', backgroundColor:'rgba(34,197,94,.12)', fill:true, tension:.35, pointRadius:0 }]}, options:o });
      chs.lat  = new Chart(ctxLat, { type:'line', data:{ labels, datasets:[{ label:'Latency', data: rand(labels.length, 60, 40), borderColor:'#84cc16', backgroundColor:'rgba(132,204,22,.12)', fill:true, tension:.35, pointRadius:0 }]}, options:o });
      chs.vol  = new Chart(ctxVol, { type:'bar',  data:{ labels, datasets:[{ label:'Volume', data: rand(labels.length, 200, 900), backgroundColor:'#22c55e', borderRadius:6 }]}, options:o });
      chs.radar= new Chart(ctxRadar,{ type:'radar', data:{ labels:['Cohesion','Availability','Throughput','Security','Decentralization'], datasets:[{ label:'Score', data:[92,96,94,93,90], borderColor:'#22c55e', backgroundColor:'rgba(34,197,94,.12)', pointBackgroundColor:'#22c55e' }]}, options:{responsive:true, scales:{ r:{ angleLines:{color:C.gridWeak}, grid:{color:C.grid}, pointLabels:{color:C.tick}, ticks:{display:false} }}, plugins:o.plugins } });
    }

    function destroyCharts(){ Object.values(chs).forEach(ch=>{ try{ ch.destroy(); }catch{} }); }

    let currentRange = '24h';
    buildCharts(currentRange);

    document.getElementById('rangeSeg').addEventListener('click', (e)=>{
      const b = e.target.closest('button[data-range]'); if(!b) return;
      [...e.currentTarget.children].forEach(c=>c.classList.toggle('active', c===b));
      currentRange = b.dataset.range;
      destroyCharts(); buildCharts(currentRange);
    });

    let liveId = null;
    document.getElementById('liveToggle').addEventListener('change', (e)=>{
      if(e.target.checked){ liveId = setInterval(()=>{
        if(!chs.perf) return; const bump = () => (Math.random()-.5)*200; const push = (ch)=>{ ch.data.labels.push(''); ch.data.labels.shift(); ch.data.datasets[0].data.push( (ch.data.datasets[0].data.slice(-1)[0]||0) + bump()); ch.data.datasets[0].data.shift(); ch.update('none'); };
        ['perf','lat','vol'].forEach(k=> push(chs[k]));
      }, 1200); }
      else { clearInterval(liveId); liveId=null; }
    });

    function applyTheme(theme){
      document.documentElement.setAttribute('data-theme', theme);
      localStorage.setItem('theme', theme);
      C = cssVars();
      Object.values(chs).forEach(ch=>{ if(!ch) return; const s=ch.options.scales; if(s?.x){ s.x.ticks.color=C.tick; s.x.grid.color=C.gridWeak; } if(s?.y){ s.y.ticks.color=C.tick; s.y.grid.color=C.grid; } ch.options.plugins.tooltip.backgroundColor=C.tbg; ch.options.plugins.tooltip.titleColor=C.ttitle; ch.options.plugins.tooltip.bodyColor=C.tbody; ch.options.plugins.tooltip.borderColor=C.tborder; ch.update('none'); });
    }
    (function themeToggle(){
      const btn=document.getElementById('themeBtn');
      const saved = localStorage.getItem('theme');
      const prefersLight = window.matchMedia && window.matchMedia('(prefers-color-scheme: light)').matches;
      applyTheme(saved || (prefersLight ? 'light' : 'quantum'));
      if(btn) btn.addEventListener('click', ()=>{ const cur=document.documentElement.getAttribute('data-theme')||'quantum'; applyTheme(cur==='light'?'quantum':'light'); btn.textContent = cur==='light' ? 'ðŸŒ—' : 'ðŸŒž'; });
    })();

    (function wallet(){
      const btn=document.getElementById('walletBtn'); const state=document.getElementById('walletState'); let connected=false; let addr=''; let provider=null;
      async function connect(){ if(typeof window.ethereum==='undefined'){ alert('MetaMask not detected. Please install MetaMask.'); return; } try{ provider=new ethers.providers.Web3Provider(window.ethereum,'any'); await provider.send('eth_requestAccounts',[]); const signer=provider.getSigner(); addr=await signer.getAddress(); connected=true; state.textContent=addr.slice(0,6)+'...'+addr.slice(-4); state.style.background='rgba(34,197,94,.15)'; btn.textContent='Disconnect'; const bal=await provider.getBalance(addr); state.title = `Balance: ${ethers.utils.formatEther(bal)} ETH`; window.ethereum.on('accountsChanged', handleAccounts); window.ethereum.on('chainChanged', ()=>location.reload()); }catch(err){ alert('Wallet connection failed: '+(err?.message||err)); } }
      function disconnect(){ connected=false; addr=''; state.textContent='Not Connected'; state.style.background='var(--glass)'; state.title=''; btn.textContent='Connect Wallet'; try{ window.ethereum?.removeListener('accountsChanged', handleAccounts);}catch{} }
      async function handleAccounts(accounts){ if(!accounts||!accounts.length){ disconnect(); return;} addr=accounts[0]; state.textContent=addr.slice(0,6)+'...'+addr.slice(-4); if(provider){ const bal=await provider.getBalance(addr); state.title=`Balance: ${ethers.utils.formatEther(bal)} ETH`; } }
      btn.addEventListener('click', async()=>{ if(!connected) await connect(); else disconnect(); });
    })();

    // Download PNG buttons
    document.querySelectorAll('[data-dl]').forEach(btn=>{ btn.addEventListener('click',()=>{ const key=btn.getAttribute('data-dl'); const ch=chs[key]; if(!ch) return; const url=ch.toBase64Image('image/png',1); const a=document.createElement('a'); a.href=url; a.download = `${key}-chart.png`; a.click(); }); });
  </script>
</body>
</html>
